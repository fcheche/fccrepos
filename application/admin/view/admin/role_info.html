<include file="public/layout" />
<body style="background-color: #FFF; overflow: auto;">
<div id="toolTipLayer" style="position: absolute; z-index: 9999; display: none; visibility: visible; left: 95px; top: 573px;"></div>
<div id="append_parent"></div>
<div id="ajaxwaitid"></div>
<div class="page">
	<div class="fixed-bar">
		<div class="item-title"><a class="back" href="javascript:history.back();" title="返回列表"><i class="fa fa-arrow-circle-o-left"></i></a>
			<div class="subject">
				<h3>管理员 - 编辑角色</h3>
				<h5>网站系统角色管理</h5>
			</div>
		</div>
	</div>
	<form class="form-horizontal" action="{:U('Admin/Admin/roleSave')}" id="roleform" method="post">
		<div class="ncap-form-default">
			<dl class="row">
				<dt class="tit">
					<label for="role_name"><em>*</em>角色名称</label>
				</dt>
				<dd class="opt">
					<input type="text" name="data[role_name]" id="role_name" value="{$detail.role_name}" class="input-txt" <if condition="$admin_info[admin_id] neq 1">readonly="readonly"</if>>
					<span class="err" id="name_err" style="display: none">导航名称不能为空!!</span>
					<p class="notic"></p>
				</dd>
			</dl>

			<dl class="row">
				<dt class="tit">
					<label for="role_name"><em>*</em>所属类别</label>
				</dt>
				<dd class="opt">
					 <select name="leibie" id="leibie">
                            <option value="">请选择类别</option>
                            <option value="1" <if condition="$detail[leibie] eq '1'"> selected="selected"</if>>短视频</option>
                            <option value="2" <if condition="$detail[leibie] eq '2'"> selected="selected"</if>>新媒体</option>
                            <option value="3" <if condition="$detail[leibie] eq '3'"> selected="selected"</if>>微博</option>
                            <option value="4" <if condition="$detail[leibie] eq '4'"> selected="selected"</if>>微信</option>
                        </select>
				</dd>
			</dl>

			<dl class="row">
				<dt class="tit">
					<label for="role_desc">角色描述</label>
				</dt>
				<dd class="opt">
					<textarea id="role_desc" name="data[role_desc]" class="tarea" rows="6" <if condition="$admin_info[admin_id] neq 1">readonly="readonly"</if>>{$detail.role_desc}</textarea>
					<span class="err" id="err_tpl_content" style="display:none;">短信内容不能为空</span>
					<p class="notic"></p>
				</dd>
			</dl>
			<dl class="row">
				<dt class="tit">
					<label for="cls_full">权限分配</label>
				</dt>
				<dd style="margin-left:200px;">
					<div class="ncap-account-container" style="border-top:none;">
						<h4>
							<input id="cls_full" onclick="choosebox(this)" type="checkbox">
							<label>全选</label>
						</h4>
					</div>

					<div class="ncap-account-container" style="border-top:none;">
							<h4>
								<label>栏目选择</label>
								<input value="1" cka="mod-{$kk}" type="checkbox">
								<label>全部</label>
							</h4>
							<ul class="ncap-account-container-list">
						<li>
										<label><input id="system" name="right[]" value="10" type="checkbox" <if condition="in_array(10,$detail['act_list'])">checked</if>>
							系统</label>
						</li>
						<li>
										<label><input id="zonghe" name="right[]" value="1" type="checkbox" <if condition="in_array(1,$detail['act_list'])">checked</if>>
							综合</label>
						</li>
						<li>
							<label><input id="taobao" name="right[]" value="3" type="checkbox" <if condition="in_array(3,$detail['act_list'])">checked</if>>
							短视频</label>
							</li>
						<li>
							<label><input id="tianmao" name="right[]" value="4" type="checkbox" <if condition="in_array(4,$detail['act_list'])">checked</if>>
							新媒体</label>
							</li>
						<li>
							<label><input id="ruzhu" name="right[]" value="5" type="checkbox" <if condition="in_array(5,$detail['act_list'])">checked</if>>
							微博</label>
						</li>
							<li>
							<label><input id="tianmao" name="right[]" value="6" type="checkbox" <if condition="in_array(6,$detail['act_list'])">checked</if>>
							微信</label>
							</li>
						<li>
							<label><input id="member" name="right[]" value="11" type="checkbox" <if condition="in_array(11,$detail['act_list'])">checked</if>>
							会员</label>
							</li>
						<li>
							<label><input id="zixun" name="right[]" value="12" type="checkbox" <if condition="in_array(12,$detail['act_list'])">checked</if>>
							咨询</label>
							</li>
						<li>
							<label><input id="caiwu" name="right[]" value="13" type="checkbox" <if condition="in_array(13,$detail['act_list'])">checked</if>>
							财务</label>
									</li>
						<li>
							<label><input id="active" name="right[]" value="14" type="checkbox" <if condition="in_array(14,$detail['act_list'])">checked</if>>
							活动</label>
									</li>
						
						<li>
										<label><input id="pbmemb" name="right[]" value="15" type="checkbox" <if condition="in_array(15,$detail['act_list'])">checked</if>>
							屏蔽会员名称</label>
						</li>
						<li>
										<label><input id="welcome" name="right[]" value="16" type="checkbox" <if condition="in_array(16,$detail['act_list'])">checked</if>>
							屏蔽首页统计页面</label>
						</li>
						<li>
										<label><input id="onsale" name="right[]" value="17" type="checkbox" <if condition="in_array(17,$detail['act_list'])">checked</if>>
							不能点击在售未售</label>
						</li>
						<li>
										<label><input id="delGoods" name="right[]" value="18" type="checkbox" <if condition="in_array(18,$detail['act_list'])">checked</if>>
							找回下架店铺</label>
						</li>
						<li>
							<label><input id="xiajia" name="right[]" value="19" type="checkbox" <if condition="in_array(19,$detail['act_list'])">checked</if>>
							下架</label>
									</li>
							</ul>
						</div>

					<foreach name="modules" item="menu" key="kk">
						<div class="ncap-account-container" style="border-top:none;">
							<h4>
								<label>{$group[$kk]}</label>
								<input value="1" cka="mod-{$kk}" type="checkbox">
								<label>全部</label>
							</h4>
							<ul class="ncap-account-container-list">
								<foreach name="menu" item="vv">
									<li>
										<label><input class="checkbox" name="right[]" value="{$vv.id}" <if condition="$vv.enable eq 1">checked</if> ck="mod-{$kk}" type="checkbox">{$vv.name}</label>
									</li>
								</foreach>
							</ul>
						</div>
					</foreach>
				</dd>
			</dl>

			<div class="bot"><a href="JavaScript:void(0);" onclick="roleSubmit();" class="ncap-btn-big ncap-btn-green" id="submitBtn">确认提交</a></div>
		</div>
		<input type="hidden" name="role_id" value="{$detail.role_id}">
	</form>
</div>
<script type="text/javascript">
	$(document).ready(function(){
		$(":checkbox[cka]").click(function(){
			var $cks = $(":checkbox[ck='"+$(this).attr("cka")+"']");
			if($(this).is(':checked')){
				$cks.each(function(){$(this).prop("checked",true);});
			}else{
				$cks.each(function(){$(this).removeAttr('checked');});
			}
		});
	});

	function choosebox(o){
		var vt = $(o).is(':checked');
		if(vt){
			$('input[type=checkbox]').prop('checked',vt);
		}else{
			$('input[type=checkbox]').removeAttr('checked');
		}
	}

	function roleSubmit(){
		if($('#role_name').val() == '' ){
			layer.alert('角色名称不能为空', {icon: 2});
			return false;
		}
		$('#roleform').submit();
	}
</script>
</body>
</html>